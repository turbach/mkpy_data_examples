
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>P50 Paired-click &#8212; mkpy_data_examples 0.0.4 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="P3 Auditory oddball" href="p3.html" />
    <link rel="prev" title="Background: EEG, events, and epochs" href="background.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="p3.html" title="P3 Auditory oddball"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="background.html" title="Background: EEG, events, and epochs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mkpy_data_examples 0.0.4 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">P50 Paired-click</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="P50-Paired-click">
<h1>P50 Paired-click<a class="headerlink" href="#P50-Paired-click" title="Permalink to this headline">Â¶</a></h1>
<p>Design:</p>
<ul class="simple">
<li><p>trial: two auditory clicks, 500 ms SOA</p></li>
<li><p>several seconds between trials, random ITI</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">mkpy</span>
<span class="kn">import</span> <span class="nn">spudtr</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">mkpy</span> <span class="kn">import</span> <span class="n">mkh5</span>
<span class="kn">from</span> <span class="nn">spudtr</span> <span class="kn">import</span> <span class="n">epf</span>

<span class="c1"># path wrangling for nbsphinx</span>
<span class="k">if</span> <span class="s2">&quot;MDE_HOME&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">MDE_HOME</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;MDE_HOME&quot;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">conf</span> <span class="kn">import</span> <span class="n">MDE_HOME</span>

<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CONDA_DEFAULT_ENV&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
<span class="k">for</span> <span class="n">pkg</span> <span class="ow">in</span> <span class="p">[</span><span class="n">np</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">mkpy</span><span class="p">,</span> <span class="n">spudtr</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pkg</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">pkg</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="n">pkg</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
spudtrE
3.8.2 (default, Mar 26 2020, 15:53:00)
[GCC 7.3.0]
numpy 1.19.1 /home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/numpy/__init__.py
pandas 1.1.3 /home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/pandas/__init__.py
mkpy 0.2.4 /home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/__init__.py
spudtr 0.0.11.dev0 /mnt/cube/home/turbach/TPU_Projects/spudtr/spudtr/__init__.py
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># set recorded ERPSS data filenames</span>
<span class="n">crw</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkdig/sub000p5.crw&quot;</span>    <span class="c1"># EEG recording</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkdig/sub000p5.x.log&quot;</span>  <span class="c1"># events</span>
<span class="n">yhdr</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkpy/sub000p5.yhdr&quot;</span>   <span class="c1"># extra header info</span>

<span class="c1"># set calibration data filenames</span>
<span class="n">cals_crw</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkdig/sub000c5.crw&quot;</span>
<span class="n">cals_log</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkdig/sub000c5.x.log&quot;</span>
<span class="n">cals_yhdr</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkpy/sub000c5.yhdr&quot;</span>

<span class="c1"># HDF5 file with EEG recording, events, and header</span>
<span class="n">p50_h5_f</span> <span class="o">=</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;data/sub000p50.h5&quot;</span>
</pre></div>
</div>
</div>
<p><strong>mkh5</strong> EEG data, event code log, header information</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p50_h5</span> <span class="o">=</span> <span class="n">mkh5</span><span class="o">.</span><span class="n">mkh5</span><span class="p">(</span><span class="n">p50_h5_f</span><span class="p">)</span>  <span class="c1"># make ready</span>

<span class="n">p50_h5</span><span class="o">.</span><span class="n">reset_all</span><span class="p">()</span>  <span class="c1"># wipe previous</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">create_mkdata</span><span class="p">(</span><span class="s2">&quot;sub000&quot;</span><span class="p">,</span> <span class="n">crw</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">yhdr</span><span class="p">)</span> <span class="c1"># convert the data to HDF5</span>

<span class="c1"># add calibration data to this subject</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">append_mkdata</span><span class="p">(</span><span class="s2">&quot;sub000&quot;</span><span class="p">,</span> <span class="n">cals_crw</span><span class="p">,</span> <span class="n">cals_log</span><span class="p">,</span> <span class="n">cals_yhdr</span><span class="p">)</span>

<span class="c1"># set calibration parameters and calibrate</span>
<span class="n">pts</span><span class="p">,</span> <span class="n">pulse</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">ccode</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">calibrate_mkdata</span><span class="p">(</span>
    <span class="s2">&quot;sub000&quot;</span><span class="p">,</span>  <span class="c1"># data group to calibrate with these cal pulses</span>
    <span class="n">n_points</span><span class="o">=</span><span class="n">pts</span><span class="p">,</span>  <span class="c1"># pts to average</span>
    <span class="n">cal_size</span><span class="o">=</span><span class="n">pulse</span><span class="p">,</span>  <span class="c1"># uV</span>
    <span class="n">lo_cursor</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span>  <span class="c1"># lo_cursor ms</span>
    <span class="n">hi_cursor</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span>  <span class="c1"># hi_cursor ms</span>
    <span class="n">cal_ccode</span><span class="o">=</span><span class="n">ccode</span><span class="p">,</span>  <span class="c1"># condition code</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:3654: UserWarning: negative event code(s) found for cal condition code 0 -16384
  warnings.warn(msg)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found cals in /sub000/dblock_2
Calibrating block /sub000/dblock_0 of 3: (219904,)
Calibrating block /sub000/dblock_1 of 3: (225280,)
Calibrating block /sub000/dblock_2 of 3: (56064,)
</pre></div></div>
</div>
<p><strong>codemap</strong></p>
<p>For this simple design the codemap a few lines of hand-typed YAML.</p>
<p>The tag column labels are for illustration, <code class="docutils literal notranslate"><span class="pre">bin</span></code> is used because it can be, not because it must.</p>
<p>The calibration events are included for comparison</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
head -14 <span class="nv">$MDE_HOME</span>/mkpy/p50_codemap.ytbl
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
# mkpy YAML codemap
#
# columns and rows must align, regexp is a mandatory column, all else is whatever

---
name: p5

columns:
    [ regexp,  ccode,  instrument,   bin,      click,    type          ]
rows:
  - [&#39;(#\d+)&#39;,     0,         cal,     0,        cal,    cal           ]
  - [&#39;(#1)&#39;,       1,         eeg,     1,    click_1,    conditioning  ]
  - [&#39;(#2)&#39;,       1,         eeg,     2,    click_2,    test          ]

</pre></div></div>
</div>
<p><strong>1. get_event_table(codemap)</strong></p>
<p>Scan the event codes for pattern matches and collect the HDF5 index, matching code, and tags</p>
<p>Event table modifications are not needed for this simple design.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p50_event_table</span> <span class="o">=</span> <span class="n">p50_h5</span><span class="o">.</span><span class="n">get_event_table</span><span class="p">(</span><span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkpy/p50_codemap.ytbl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
searching codes in: sub000/dblock_0
searching codes in: sub000/dblock_1
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1046: UserWarning:
As of mkpy 0.2.0 to match events with a codemap regexp pattern, the
ccode column in p50_codemap.ytbl must also match the log_ccode
in the datablock. If this behavior is not desired, delete or rename
the ccode column in the codemap.
  warnings.warn(msg)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
searching codes in: sub000/dblock_2
</pre></div></div>
</div>
<p><strong>inspect the event table</strong></p>
<p>Check that the codemap scan returned all and only the correct events and tags.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;event table shape:&quot;</span><span class="p">,</span> <span class="n">p50_event_table</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;event table columns:&quot;</span><span class="p">,</span> <span class="n">p50_event_table</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>

<span class="c1"># select some columns to show</span>
<span class="n">example_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;dblock_path&quot;</span><span class="p">,</span> <span class="s2">&quot;dblock_ticks&quot;</span><span class="p">,</span> <span class="s2">&quot;log_evcodes&quot;</span><span class="p">,</span> <span class="s2">&quot;log_ccodes&quot;</span><span class="p">,</span> <span class="s2">&quot;log_flags&quot;</span><span class="p">,</span>
    <span class="s2">&quot;regexp&quot;</span><span class="p">,</span> <span class="s2">&quot;match_code&quot;</span><span class="p">,</span> <span class="s2">&quot;instrument&quot;</span><span class="p">,</span> <span class="s2">&quot;bin&quot;</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span>
<span class="p">]</span>

<span class="c1"># first few stimulus events</span>
<span class="n">display</span><span class="p">(</span><span class="n">p50_event_table</span><span class="p">[</span><span class="n">example_columns</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># last few calibration pulse events</span>
<span class="n">display</span><span class="p">(</span><span class="n">p50_event_table</span><span class="p">[</span><span class="n">example_columns</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>

<span class="c1"># tally and check event counts</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span>
        <span class="n">p50_event_table</span><span class="o">.</span><span class="n">ccode</span><span class="p">,</span>
        <span class="n">p50_event_table</span><span class="o">.</span><span class="n">instrument</span><span class="p">,</span>
        <span class="n">p50_event_table</span><span class="o">.</span><span class="n">bin</span><span class="p">,</span>
        <span class="n">p50_event_table</span><span class="o">.</span><span class="n">click</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
        <span class="n">p50_event_table</span><span class="o">.</span><span class="n">log_flags</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">margins</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
event table shape: (448, 29)
event table columns: [&#39;data_group&#39;, &#39;dblock_path&#39;, &#39;dblock_tick_idx&#39;, &#39;dblock_ticks&#39;, &#39;crw_ticks&#39;, &#39;raw_evcodes&#39;, &#39;log_evcodes&#39;, &#39;log_ccodes&#39;, &#39;log_flags&#39;, &#39;epoch_match_tick_delta&#39;, &#39;epoch_ticks&#39;, &#39;dblock_srate&#39;, &#39;match_group&#39;, &#39;idx&#39;, &#39;dlim&#39;, &#39;anchor_str&#39;, &#39;match_str&#39;, &#39;anchor_code&#39;, &#39;match_code&#39;, &#39;anchor_tick&#39;, &#39;match_tick&#39;, &#39;anchor_tick_delta&#39;, &#39;is_anchor&#39;, &#39;regexp&#39;, &#39;ccode&#39;, &#39;instrument&#39;, &#39;bin&#39;, &#39;click&#39;, &#39;type&#39;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dblock_path</th>
      <th>dblock_ticks</th>
      <th>log_evcodes</th>
      <th>log_ccodes</th>
      <th>log_flags</th>
      <th>regexp</th>
      <th>match_code</th>
      <th>instrument</th>
      <th>bin</th>
      <th>click</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>120</th>
      <td>sub000/dblock_0</td>
      <td>606</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>(#1)</td>
      <td>1</td>
      <td>eeg</td>
      <td>1</td>
      <td>click_1</td>
      <td>conditioning</td>
    </tr>
    <tr>
      <th>121</th>
      <td>sub000/dblock_0</td>
      <td>3792</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>(#1)</td>
      <td>1</td>
      <td>eeg</td>
      <td>1</td>
      <td>click_1</td>
      <td>conditioning</td>
    </tr>
    <tr>
      <th>122</th>
      <td>sub000/dblock_0</td>
      <td>7714</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>(#1)</td>
      <td>1</td>
      <td>eeg</td>
      <td>1</td>
      <td>click_1</td>
      <td>conditioning</td>
    </tr>
    <tr>
      <th>123</th>
      <td>sub000/dblock_0</td>
      <td>10771</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>(#1)</td>
      <td>1</td>
      <td>eeg</td>
      <td>1</td>
      <td>click_1</td>
      <td>conditioning</td>
    </tr>
    <tr>
      <th>124</th>
      <td>sub000/dblock_0</td>
      <td>13980</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>(#1)</td>
      <td>1</td>
      <td>eeg</td>
      <td>1</td>
      <td>click_1</td>
      <td>conditioning</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dblock_path</th>
      <th>dblock_ticks</th>
      <th>log_evcodes</th>
      <th>log_ccodes</th>
      <th>log_flags</th>
      <th>regexp</th>
      <th>match_code</th>
      <th>instrument</th>
      <th>bin</th>
      <th>click</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>683</th>
      <td>sub000/dblock_2</td>
      <td>54179</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>(#\d+)</td>
      <td>4</td>
      <td>cal</td>
      <td>0</td>
      <td>cal</td>
      <td>cal</td>
    </tr>
    <tr>
      <th>684</th>
      <td>sub000/dblock_2</td>
      <td>54437</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>(#\d+)</td>
      <td>2</td>
      <td>cal</td>
      <td>0</td>
      <td>cal</td>
      <td>cal</td>
    </tr>
    <tr>
      <th>685</th>
      <td>sub000/dblock_2</td>
      <td>54695</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>(#\d+)</td>
      <td>3</td>
      <td>cal</td>
      <td>0</td>
      <td>cal</td>
      <td>cal</td>
    </tr>
    <tr>
      <th>686</th>
      <td>sub000/dblock_2</td>
      <td>54954</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>(#\d+)</td>
      <td>4</td>
      <td>cal</td>
      <td>0</td>
      <td>cal</td>
      <td>cal</td>
    </tr>
    <tr>
      <th>687</th>
      <td>sub000/dblock_2</td>
      <td>55212</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>(#\d+)</td>
      <td>2</td>
      <td>cal</td>
      <td>0</td>
      <td>cal</td>
      <td>cal</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>log_flags</th>
      <th>0</th>
      <th>32</th>
      <th>48</th>
      <th>64</th>
      <th>All</th>
    </tr>
    <tr>
      <th>ccode</th>
      <th>instrument</th>
      <th>bin</th>
      <th>click</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>cal</th>
      <th>0</th>
      <th>cal</th>
      <td>207</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>208</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th rowspan="2" valign="top">eeg</th>
      <th>1</th>
      <th>click_1</th>
      <td>117</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
    </tr>
    <tr>
      <th>2</th>
      <th>click_2</th>
      <td>114</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>120</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <th></th>
      <th></th>
      <td>438</td>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>448</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>2. set_epochs(name, pre, post)</strong></p>
<p>Stash the the event table events and tags with a name and epoch interval boundaries.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p50_h5</span><span class="o">.</span><span class="n">set_epochs</span><span class="p">(</span><span class="s2">&quot;ms1500&quot;</span><span class="p">,</span> <span class="n">p50_event_table</span><span class="p">,</span> <span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sanitizing event table data types for mkh5 epochs table ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (240, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 0, 360, 360, 1, 1, 0, 64, -375, 750, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 360, 360, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 360, -375, 750)
  warnings.warn(
</pre></div></div>
</div>
<p><strong>3. export_epochs(name, file_format=â¦)</strong></p>
<p>Export the time-stamped, tagged, fixed-length segments of EEG data for analysis as HDF5, pandas HDF5 or feather</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># this exports the epochs DATA ... indexed, timstamped, EEG, events, and tags.</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">export_epochs</span><span class="p">(</span><span class="s2">&quot;ms1500&quot;</span><span class="p">,</span> <span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;data/sub000p50.ms1500.epochs.feather&quot;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;feather&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>analyze epochs</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">p50_epochs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_feather</span><span class="p">(</span><span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;data/sub000p50.ms1500.epochs.feather&quot;</span><span class="p">)</span>

<span class="c1"># sanitize epoch_id for pandas index</span>
<span class="n">p50_epochs</span><span class="p">[</span><span class="s1">&#39;epoch_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p50_epochs</span><span class="p">[</span><span class="s1">&#39;epoch_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>

<span class="c1"># look up pattern-matched events with timestamp 0</span>
<span class="n">p50_events</span> <span class="o">=</span> <span class="n">p50_epochs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;match_time==0&quot;</span><span class="p">)</span>
<span class="n">p50_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span>
    <span class="p">[</span><span class="n">p50_events</span><span class="o">.</span><span class="n">instrument</span><span class="p">,</span> <span class="n">p50_events</span><span class="o">.</span><span class="n">ccode</span><span class="p">,</span> <span class="n">p50_events</span><span class="o">.</span><span class="n">bin</span><span class="p">,</span> <span class="n">p50_events</span><span class="o">.</span><span class="n">click</span><span class="p">,</span> <span class="n">p50_events</span><span class="o">.</span><span class="n">type</span><span class="p">],</span>
    <span class="p">[</span><span class="n">p50_events</span><span class="o">.</span><span class="n">log_flags</span><span class="p">],</span>
    <span class="n">margins</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># lookup scalp potential channels ... EEG, EOG, A2</span>
<span class="n">p50_chans</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">p50_epochs</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[MLRAHlr]\w{1,3}$&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">)]</span>
<span class="n">p50_chandesc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p50_chans</span><span class="p">):</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">p50_chandesc</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s2">4s</span><span class="si">}{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;channels: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">p50_chans</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">chdesc:</span><span class="si">{</span><span class="n">p50_chandesc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">p50_counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
channels: 32
chdesc: 0:lle   1:lhz   2:MiPf  3:LLPf  4:RLPf  5:LMPf  6:RMPf  7:LDFr
 8:RDFr  9:LLFr 10:RLFr 11:LMFr 12:RMFr 13:LMCe 14:RMCe 15:MiCe
16:MiPa 17:LDCe 18:RDCe 19:LDPa 20:RDPa 21:LMOc 22:RMOc 23:LLTe
24:RLTe 25:LLOc 26:RLOc 27:MiOc 28:A2   29:HEOG 30:rle  31:rhz

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>log_flags</th>
      <th>0</th>
      <th>32</th>
      <th>48</th>
      <th>All</th>
    </tr>
    <tr>
      <th>instrument</th>
      <th>ccode</th>
      <th>bin</th>
      <th>click</th>
      <th>type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cal</th>
      <th>0</th>
      <th>0</th>
      <th>cal</th>
      <th>cal</th>
      <td>207</td>
      <td>0</td>
      <td>0</td>
      <td>207</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">eeg</th>
      <th rowspan="2" valign="top">1</th>
      <th>1</th>
      <th>click_1</th>
      <th>conditioning</th>
      <td>117</td>
      <td>3</td>
      <td>0</td>
      <td>120</td>
    </tr>
    <tr>
      <th>2</th>
      <th>click_2</th>
      <th>test</th>
      <td>114</td>
      <td>5</td>
      <td>1</td>
      <td>120</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <td>438</td>
      <td>8</td>
      <td>1</td>
      <td>447</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># for illustration ... cal pulses and first click</span>
<span class="n">midline</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MiPf&quot;</span><span class="p">,</span> <span class="s2">&quot;MiCe&quot;</span><span class="p">,</span> <span class="s2">&quot;MiPa&quot;</span><span class="p">,</span> <span class="s2">&quot;MiOc&quot;</span><span class="p">]</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">p50_epochs</span><span class="o">.</span><span class="n">bin</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">midline_epochs</span> <span class="o">=</span> <span class="n">p50_epochs</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;epoch_id&quot;</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="s2">&quot;match_time&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">midline</span>
<span class="p">]</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;click in [&#39;cal&#39;, &#39;click_1&#39;]&quot;</span><span class="p">)</span>

<span class="c1"># center each channel</span>
<span class="n">midline_epochs</span> <span class="o">=</span> <span class="n">epf</span><span class="o">.</span><span class="n">center_eeg</span><span class="p">(</span>
    <span class="n">midline_epochs</span><span class="p">,</span>
    <span class="n">midline</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">epoch_id</span><span class="o">=</span><span class="s2">&quot;epoch_id&quot;</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="s2">&quot;match_time&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># look up single trial click_2 event timestamp relative to click_1 onset (match_time)</span>
<span class="n">click2_onsets</span> <span class="o">=</span> <span class="n">p50_epochs</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="s2">&quot;ccode &gt; 0 and match_code == 1 and log_evcodes == 2&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">match_time</span>

<span class="n">click2_onset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">click2_onsets</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">click2_onsets</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">click2_onsets</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">click2_onset</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
502    101
506      7
504      7
500      5
Name: match_time, dtype: int64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
count    120.000000
mean     502.266667
std        1.128197
min      500.000000
25%      502.000000
50%      502.000000
75%      502.000000
max      506.000000
Name: match_time, dtype: float64
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
502
</pre></div></div>
</div>
<p><strong>time-domain average paired-click ERPs</strong></p>
<p>The 10 microvolt calibration square is for illustration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">midline_erps</span> <span class="o">=</span> <span class="n">midline_epochs</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="s2">&quot;match_time&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">midline_erps</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>click</th>
      <th>match_time</th>
      <th>epoch_id</th>
      <th>MiPf</th>
      <th>MiCe</th>
      <th>MiPa</th>
      <th>MiOc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cal</td>
      <td>-750</td>
      <td>344.0</td>
      <td>0.031777</td>
      <td>0.030263</td>
      <td>-0.008570</td>
      <td>-0.021974</td>
    </tr>
    <tr>
      <th>1</th>
      <td>cal</td>
      <td>-748</td>
      <td>344.0</td>
      <td>0.026993</td>
      <td>0.027894</td>
      <td>-0.053359</td>
      <td>-0.093315</td>
    </tr>
    <tr>
      <th>2</th>
      <td>cal</td>
      <td>-746</td>
      <td>344.0</td>
      <td>0.034188</td>
      <td>0.004735</td>
      <td>-0.031715</td>
      <td>-0.074623</td>
    </tr>
    <tr>
      <th>3</th>
      <td>cal</td>
      <td>-744</td>
      <td>344.0</td>
      <td>0.036570</td>
      <td>0.013279</td>
      <td>-0.016684</td>
      <td>-0.045383</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cal</td>
      <td>-742</td>
      <td>344.0</td>
      <td>0.027017</td>
      <td>0.016949</td>
      <td>0.012113</td>
      <td>-0.041882</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1495</th>
      <td>click_1</td>
      <td>740</td>
      <td>89.5</td>
      <td>-3.296837</td>
      <td>-4.691502</td>
      <td>-1.160323</td>
      <td>0.269139</td>
    </tr>
    <tr>
      <th>1496</th>
      <td>click_1</td>
      <td>742</td>
      <td>89.5</td>
      <td>-3.073172</td>
      <td>-4.794128</td>
      <td>-1.390727</td>
      <td>0.152291</td>
    </tr>
    <tr>
      <th>1497</th>
      <td>click_1</td>
      <td>744</td>
      <td>89.5</td>
      <td>-2.999067</td>
      <td>-5.094552</td>
      <td>-1.737775</td>
      <td>-0.031446</td>
    </tr>
    <tr>
      <th>1498</th>
      <td>click_1</td>
      <td>746</td>
      <td>89.5</td>
      <td>-3.031741</td>
      <td>-5.235142</td>
      <td>-1.946156</td>
      <td>-0.063351</td>
    </tr>
    <tr>
      <th>1499</th>
      <td>click_1</td>
      <td>748</td>
      <td>89.5</td>
      <td>-2.809215</td>
      <td>-5.238110</td>
      <td>-1.969507</td>
      <td>-0.031548</td>
    </tr>
  </tbody>
</table>
<p>1500 rows Ã 7 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cal&quot;</span><span class="p">:</span> <span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="s2">&quot;click_1&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;click_2&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">erp</span> <span class="ow">in</span> <span class="n">midline_erps</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">axi</span><span class="p">,</span> <span class="n">chan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">midline</span><span class="p">):</span>

        <span class="c1"># mark onsets</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">axi</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">axi</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">click2_onset</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="n">axi</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">erp</span><span class="p">[</span><span class="s2">&quot;match_time&quot;</span><span class="p">],</span>
            <span class="n">erp</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">tag</span><span class="p">],</span>
            <span class="n">label</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># channel</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">axi</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">chan</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Paired-click P50 all trials&quot;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/p50_21_0.png" src="_images/p50_21_0.png" />
</div>
</div>
<p><strong>Single subject pipeline with epoch export in different formats</strong></p>
<p>build and calibrate the mkpy HDF5 format data file</p>
<ol class="arabic simple">
<li><p>get_event_table(<em>codemap</em>)</p></li>
<li><p>set_epoch_table(<em>name</em>, <em>event_table</em>, <em>pre</em>, <em>post</em>)</p></li>
<li><p>export_epochs(<em>name</em>, <em>file_format=â¦</em>)</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>

<span class="c1"># build mkpy.mkh5 format data file and calibrate</span>
<span class="n">p50_h5</span> <span class="o">=</span> <span class="n">mkh5</span><span class="o">.</span><span class="n">mkh5</span><span class="p">(</span><span class="n">p50_h5_f</span><span class="p">)</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">reset_all</span><span class="p">()</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">create_mkdata</span><span class="p">(</span><span class="s2">&quot;sub000&quot;</span><span class="p">,</span> <span class="n">crw</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">yhdr</span><span class="p">)</span>

<span class="n">p50_h5</span><span class="o">.</span><span class="n">append_mkdata</span><span class="p">(</span><span class="s2">&quot;sub000&quot;</span><span class="p">,</span> <span class="n">cals_crw</span><span class="p">,</span> <span class="n">cals_log</span><span class="p">,</span> <span class="n">cals_yhdr</span><span class="p">)</span>

<span class="n">pts</span><span class="p">,</span> <span class="n">pulse</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">ccode</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">p50_h5</span><span class="o">.</span><span class="n">calibrate_mkdata</span><span class="p">(</span>
    <span class="s2">&quot;sub000&quot;</span><span class="p">,</span>
    <span class="n">n_points</span><span class="o">=</span><span class="n">pts</span><span class="p">,</span>
    <span class="n">cal_size</span><span class="o">=</span><span class="n">pulse</span><span class="p">,</span>
    <span class="n">lo_cursor</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span>
    <span class="n">hi_cursor</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span>
    <span class="n">cal_ccode</span><span class="o">=</span><span class="n">ccode</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># 1. scan event code pattern tags into the event table</span>
<span class="n">p50_event_table</span> <span class="o">=</span> <span class="n">p50_h5</span><span class="o">.</span><span class="n">get_event_table</span><span class="p">(</span><span class="n">MDE_HOME</span> <span class="o">/</span> <span class="s2">&quot;mkpy/p50_codemap.ytbl&quot;</span><span class="p">)</span>


<span class="c1"># use these to set the epoch table name, and pre, post stimulus boundaries</span>
<span class="n">epoch_specs</span>  <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ms100&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="s2">&quot;ms1500&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span>
    <span class="s2">&quot;ms3000&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">1500</span><span class="p">),</span>
    <span class="s2">&quot;ms10000&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">),</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">epoch_name</span><span class="p">,</span> <span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span> <span class="ow">in</span> <span class="n">epoch_specs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">epoch_name</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span>

    <span class="c1"># 2. set the epoch_table names and interval boundaries</span>
    <span class="n">p50_h5</span><span class="o">.</span><span class="n">set_epochs</span><span class="p">(</span><span class="n">epoch_name</span><span class="p">,</span> <span class="n">p50_event_table</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span>

    <span class="c1"># multiple export formats for demonstration, in practice pick one format</span>
    <span class="n">fformats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;h5&quot;</span><span class="p">,</span> <span class="s2">&quot;pdh5&quot;</span><span class="p">,</span> <span class="s2">&quot;feather&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ffmt</span> <span class="ow">in</span> <span class="n">fformats</span><span class="p">:</span>
        <span class="n">_fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">MDE_HOME</span><span class="si">}</span><span class="s2">/data/sub000p50.</span><span class="si">{</span><span class="n">epoch_name</span><span class="si">}</span><span class="s2">.epochs.</span><span class="si">{</span><span class="n">ffmt</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;exporting p50 </span><span class="si">{</span><span class="n">epoch_name</span><span class="si">}</span><span class="s2"> as </span><span class="si">{</span><span class="n">ffmt</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">_fname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># 3.  export the epochs DATA ... EEG and events.</span>
        <span class="n">p50_h5</span><span class="o">.</span><span class="n">export_epochs</span><span class="p">(</span><span class="n">epoch_name</span><span class="p">,</span> <span class="n">_fname</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="n">ffmt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:3654: UserWarning: negative event code(s) found for cal condition code 0 -16384
  warnings.warn(msg)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found cals in /sub000/dblock_2
Calibrating block /sub000/dblock_0 of 3: (219904,)
Calibrating block /sub000/dblock_1 of 3: (225280,)
Calibrating block /sub000/dblock_2 of 3: (56064,)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1046: UserWarning:
As of mkpy 0.2.0 to match events with a codemap regexp pattern, the
ccode column in p50_codemap.ytbl must also match the log_ccode
in the datablock. If this behavior is not desired, delete or rename
the ccode column in the codemap.
  warnings.warn(msg)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
searching codes in: sub000/dblock_0
searching codes in: sub000/dblock_1
searching codes in: sub000/dblock_2
ms100 -50 50
Sanitizing event table data types for mkh5 epochs table ...
exporting p50 ms100 as h5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms100.epochs.h5
exporting p50 ms100 as pdh5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms100.epochs.pdh5
exporting p50 ms100 as feather: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms100.epochs.feather
ms1500 -750 750
Sanitizing event table data types for mkh5 epochs table ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (240, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 0, 360, 360, 1, 1, 0, 64, -375, 750, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 360, 360, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 360, -375, 750)
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exporting p50 ms1500 as h5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms1500.epochs.h5
exporting p50 ms1500 as pdh5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms1500.epochs.pdh5
exporting p50 ms1500 as feather: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms1500.epochs.feather
ms3000 -1500 1500
Sanitizing event table data types for mkh5 epochs table ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (0, b&#39;sub000&#39;, b&#39;sub000/dblock_0&#39;, 0, 606, 606, 1, 1, 1, 0, -750, 1500, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 606, 606, 0, True, b&#39;(#1)&#39;, 1, b&#39;eeg&#39;, 1, b&#39;click_1&#39;, b&#39;conditioning&#39;, 0, 0, 0, 606, -750, 1500)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (120, b&#39;sub000&#39;, b&#39;sub000/dblock_1&#39;, 0, 517, 220421, 1, 1, 1, 32, -750, 1500, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 517, 517, 0, True, b&#39;(#1)&#39;, 1, b&#39;eeg&#39;, 1, b&#39;click_1&#39;, b&#39;conditioning&#39;, 0, 0, 0, 517, -750, 1500)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (240, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 0, 360, 360, 1, 1, 0, 64, -750, 1500, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 360, 360, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 360, -750, 1500)
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exporting p50 ms3000 as h5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms3000.epochs.h5
exporting p50 ms3000 as pdh5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms3000.epochs.pdh5
exporting p50 ms3000 as feather: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms3000.epochs.feather
ms10000 -5000 5000
Sanitizing event table data types for mkh5 epochs table ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (0, b&#39;sub000&#39;, b&#39;sub000/dblock_0&#39;, 0, 606, 606, 1, 1, 1, 0, -2500, 5000, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 606, 606, 0, True, b&#39;(#1)&#39;, 1, b&#39;eeg&#39;, 1, b&#39;click_1&#39;, b&#39;conditioning&#39;, 0, 0, 0, 606, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (59, b&#39;sub000&#39;, b&#39;sub000/dblock_0&#39;, 118, 218149, 218149, 1, 1, 1, 0, -2500, 5000, 500., 1, 118, 237, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 218149, 218149, 0, True, b&#39;(#1)&#39;, 1, b&#39;eeg&#39;, 1, b&#39;click_1&#39;, b&#39;conditioning&#39;, 0, 0, 0, 218149, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (60, b&#39;sub000&#39;, b&#39;sub000/dblock_0&#39;, 1, 857, 857, 2, 2, 1, 0, -2500, 5000, 500., 1, 1, 3, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 857, 857, 0, True, b&#39;(#2)&#39;, 1, b&#39;eeg&#39;, 2, b&#39;click_2&#39;, b&#39;test&#39;, 0, 0, 0, 857, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (119, b&#39;sub000&#39;, b&#39;sub000/dblock_0&#39;, 119, 218400, 218400, 2, 2, 1, 0, -2500, 5000, 500., 1, 119, 239, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 218400, 218400, 0, True, b&#39;(#2)&#39;, 1, b&#39;eeg&#39;, 2, b&#39;click_2&#39;, b&#39;test&#39;, 0, 0, 0, 218400, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (120, b&#39;sub000&#39;, b&#39;sub000/dblock_1&#39;, 0, 517, 220421, 1, 1, 1, 32, -2500, 5000, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 517, 517, 0, True, b&#39;(#1)&#39;, 1, b&#39;eeg&#39;, 1, b&#39;click_1&#39;, b&#39;conditioning&#39;, 0, 0, 0, 517, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (179, b&#39;sub000&#39;, b&#39;sub000/dblock_1&#39;, 118, 223728, 443632, 1, 1, 1, 0, -2500, 5000, 500., 1, 118, 237, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 223728, 223728, 0, True, b&#39;(#1)&#39;, 1, b&#39;eeg&#39;, 1, b&#39;click_1&#39;, b&#39;conditioning&#39;, 0, 0, 0, 223728, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (180, b&#39;sub000&#39;, b&#39;sub000/dblock_1&#39;, 1, 769, 220673, 2, 2, 1, 32, -2500, 5000, 500., 1, 1, 3, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 769, 769, 0, True, b&#39;(#2)&#39;, 1, b&#39;eeg&#39;, 2, b&#39;click_2&#39;, b&#39;test&#39;, 0, 0, 0, 769, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (239, b&#39;sub000&#39;, b&#39;sub000/dblock_1&#39;, 119, 223979, 443883, 2, 2, 1, 0, -2500, 5000, 500., 1, 119, 239, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 223979, 223979, 0, True, b&#39;(#2)&#39;, 1, b&#39;eeg&#39;, 2, b&#39;click_2&#39;, b&#39;test&#39;, 0, 0, 0, 223979, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (240, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 0, 360, 360, 1, 1, 0, 64, -2500, 5000, 500., 1, 0, 1, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 360, 360, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 360, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (241, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 1, 1077, 1077, 4, 4, 0, 0, -2500, 5000, 500., 1, 1, 3, b&#39;4&#39;, b&#39;4&#39;, 4, 4, 1077, 1077, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 1077, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1501: UserWarning: data error: pre-stimulus interval is out of bounds left ... skipping epoch (242, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 2, 1794, 1794, 2, 2, 0, 0, -2500, 5000, 500., 1, 2, 5, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 1794, 1794, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 1794, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (441, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 201, 53662, 53662, 4, 4, 0, 0, -2500, 5000, 500., 1, 201, 403, b&#39;4&#39;, b&#39;4&#39;, 4, 4, 53662, 53662, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 53662, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (442, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 202, 53920, 53920, 1, 1, 0, 0, -2500, 5000, 500., 1, 202, 405, b&#39;1&#39;, b&#39;1&#39;, 1, 1, 53920, 53920, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 53920, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (443, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 203, 54179, 54179, 4, 4, 0, 0, -2500, 5000, 500., 1, 203, 407, b&#39;4&#39;, b&#39;4&#39;, 4, 4, 54179, 54179, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 54179, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (444, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 204, 54437, 54437, 2, 2, 0, 0, -2500, 5000, 500., 1, 204, 409, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 54437, 54437, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 54437, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (445, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 205, 54695, 54695, 3, 3, 0, 0, -2500, 5000, 500., 1, 205, 411, b&#39;3&#39;, b&#39;3&#39;, 3, 3, 54695, 54695, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 54695, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (446, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 206, 54954, 54954, 4, 4, 0, 0, -2500, 5000, 500., 1, 206, 413, b&#39;4&#39;, b&#39;4&#39;, 4, 4, 54954, 54954, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 54954, -2500, 5000)
  warnings.warn(
/home/turbach/miniconda3/envs/spudtrE/lib/python3.8/site-packages/mkpy/mkh5.py:1507: UserWarning: data error: post-stimulus interval is out of bounds right ... skipping epoch (447, b&#39;sub000&#39;, b&#39;sub000/dblock_2&#39;, 207, 55212, 55212, 2, 2, 0, 0, -2500, 5000, 500., 1, 207, 415, b&#39;2&#39;, b&#39;2&#39;, 2, 2, 55212, 55212, 0, True, b&#39;(#\\d+)&#39;, 0, b&#39;cal&#39;, 0, b&#39;cal&#39;, b&#39;cal&#39;, 0, 0, 0, 55212, -2500, 5000)
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
exporting p50 ms10000 as h5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms10000.epochs.h5
exporting p50 ms10000 as pdh5: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms10000.epochs.pdh5
exporting p50 ms10000 as feather: /mnt/cube/home/turbach/TPU_Projects/mkpy_data_examples/data/sub000p50.ms10000.epochs.feather
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="background.html">Background: EEG, events, and epochs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">P50 Paired-click</a></li>
<li class="toctree-l1"><a class="reference internal" href="p3.html">P3 Auditory oddball</a></li>
<li class="toctree-l1"><a class="reference internal" href="wr.html">Word repetition memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="pm.html">Picture memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="resting_eeg.html">Resting EEG</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="background.html"
                        title="previous chapter">Background: EEG, events, and epochs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="p3.html"
                        title="next chapter">P3 Auditory oddball</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="p3.html" title="P3 Auditory oddball"
             >next</a> |</li>
        <li class="right" >
          <a href="background.html" title="Background: EEG, events, and epochs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mkpy_data_examples 0.0.4 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">P50 Paired-click</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Thomas P. Urbach.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>